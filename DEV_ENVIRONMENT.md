# MCPM Local Development Environment

This document explains how to test MCPM CLI with local server data during development.

## Environment Variable Configuration

The MCPM CLI can now be configured to use a custom repository URL through the `MCPM_REPO_URL` environment variable.

### Default Behavior

By default, MCPM fetches server data from: `https://mcpm.sh/api/servers.json`

### Override with Environment Variable

You can override the repository URL by setting the `MCPM_REPO_URL` environment variable:

```bash
# Use local file
export MCPM_REPO_URL="file:///path/to/local/servers.json"

# Use local development server
export MCPM_REPO_URL="http://localhost:4000/api/servers.json"

# Use custom remote URL
export MCPM_REPO_URL="https://your-custom-api.com/servers.json"
```

## Testing with Local Server Data

### Method 1: Manual Environment Variable

1. Generate local servers.json:

   ```bash
   ./scripts/prepare.sh _dev
   ```

2. Run CLI with local data:
   ```bash
   MCPM_REPO_URL="file://${PWD}/_dev/api/servers.json" python3 test_cli.py search
   ```

### Method 2: Helper Script (Recommended)

Use the provided helper script that automatically handles setup:

```bash
# Make the script executable (first time only)
chmod +x test_cli_local.sh

# Run any CLI command with local data
./test_cli_local.sh search
./test_cli_local.sh info figma
./test_cli_local.sh search --table
```

The helper script will:

- Automatically generate `_dev/api/servers.json` if it doesn't exist
- Set the appropriate `MCPM_REPO_URL` environment variable
- Run the CLI with local server data

## Supported URL Formats

- **HTTP/HTTPS URLs**: `https://api.example.com/servers.json`
- **File URLs**: `file:///absolute/path/to/servers.json`

## Use Cases

1. **Testing local server definitions** before submitting to the registry
2. **Development with offline environments**
3. **Using custom/private server registries**
4. **Testing API changes** without affecting production

## File Format

The local `servers.json` file should follow the same format as the remote API:

```json
{
  "server-name": {
    "name": "server-name",
    "description": "Server description",
    "categories": ["category1"],
    "tags": ["tag1", "tag2"]
    // ... other server metadata
  }
}
```

This file is automatically generated from the individual JSON files in `mcp-registry/servers/` by the prepare script.
